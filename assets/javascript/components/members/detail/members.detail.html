<a class="btn btn-default pull-right" ui-sref="members.edit({id: member.id})">Redigera</a>
<h1>{{member.first_name}} {{member.last_name}}</h1>
<div class="row">
  <div class="col-md-6">
    <div class="panel panel-default">
      <div class="panel-heading">Personuppgifter</div>
      <div class="panel-body">
        <p>{{member.first_name}} {{member.last_name}}<br />
        {{member.street_address}}<br />
        {{member.postcode}} {{member.city}}<br />
        {{member.country.name}}
        </p>
        <p>Kön: {{member.gender.name}}<br />
        Personnummer: {{member.personal_number}}</p>
        <p><strong>Kontaktuppgifter</strong>:<br />
        <a href="mailto:{{member.email}}" ng-show="member.email">{{member.email}}</a><br />
        <span ng-show="member.phone">{{member.phone}}</span><br />
        <a href="http://www.facebook.com/{{member.facebook}}" ng-show="member.facebook">{{member.facebook}}</a>
        <a href="http://www.twitter.com/{{member.twitter}}" ng-show="member.twitter">{{member.twitter}}</a>

        </p>
      </div>
    </div>
  </div>
  <div class="col-md-6">
    <div class="panel panel-default">
      <div class="panel-heading">Medlemsuppgifter</div>
      <div class="panel-body">
        <p>
          Medlemsnummer: {{member.id}}<br />
          Medlem sedan: {{member.member_since}}<br />
          Medlem tom: {{member.member_until}}
        </p>
        <h5><a href="" ng-click="paymentsIsOpen = !paymentsIsOpen">Inbetalningar ({{member.payments.length}})</a></h5>
        <div uib-collapse="!paymentsIsOpen">
          <div ng-hide="member.payments.length">
            <p>Inga inbetalninar har gjorts</p>
          </div>
          <table ng-show="member.payments.length" class="table table-bordered table-hover table-condensed">
            <tr>
              <th>Id</th>
              <th>Datum</th>
              <th>Summa</th>
              <th>Betalningsmetod</th>
              <th>Registrerad av</th>
              <th>Ändra</th>
            </tr>
            <tr ng-repeat="payment in member.payments">
              <td>{{payment.id}}</td>
              <td>
                <span editable-date="payment.payment_date" e-name="payment_date" e-form="rowform" e-required>
                  {{ payment.payment_date }}
                </span>
              </td>
              <td>
                <span editable-number="payment.amount" e-name="amount" e-form="rowform" e-required>
                  {{payment.amount}}
                </span>
              </td>
              <td>
                  <span editable-select="payment.payment_method_id" e-name="payment_method_id" onshow="loadPaymentMethods()" e-form="rowform" e-ng-options="p.id as p.name for p in paymentMethods">
                    {{payment.payment_method.name}}
                  </span>
              </td>
              <td>
                <a ui-sref="members.detail({id: payment.created_by.id})">{{payment.created_by.first_name}} {{payment.created_by.last_name}}</a>
              </td>
              <td>
                <form editable-form name="rowform" onbeforesave="savePayment($data, member.id)" ng-show="rowform.$visible" class="form-buttons form-inline" shown="insertedPayment == payment">
                  <button type="submit" ng-disabled="rowform.$waiting" class="btn btn-primary">
                    save
                  </button>
                  <button type="button" ng-disabled="rowform.$waiting" ng-click="rowform.$cancel()" class="btn btn-default">
                    cancel
                  </button>
                </form>
                <div class="buttons" ng-show="!rowform.$visible">
                  <button class="btn btn-primary" ng-click="rowform.$show()">edit</button>
                  <button class="btn btn-danger" ng-click="removeMember($index)">del</button>
                </div> 
              </td>
            </tr>
          </table>
          <p>
            <a class="btn btn-success" ng-click="addPayment()">Lägg till betalning manuellt</a>
          </p>
        </div>
        <h5><a href="" ng-click="paymentRemindersIsOpen = !paymentRemindersIsOpen">Påminnelser om förnyat medlemskap ({{paymentReminders.length}})</a></h5>
        <div uib-collapse="!paymentRemindersIsOpen">
          <p ng-hide="paymentReminders.length">Inga påminnelser har skickats.</p>
          <table ng-show="paymentReminders.length" class="table table-bordered table-hover table-condensed">
            <tr>
              <th>Id</th>
              <th>Metod</th>
              <th>Skickad</th>
            </tr>
            <tr ng-repeat="reminder in paymentReminders">
              <td>{{reminder.id}}</td>
              <td>{{reminder.method}}</td>
              <td>{{reminder.created_at}}</td>
            </tr>
          </table>
          <p>
            <a class="btn btn-success" ng-click="sendPaymentReminder()">Påminn medlem om betalning</a> 
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
